dsl_version: 0.1.0
service:
  name: nova-compute-ironic
  kind: DaemonSet
  containers:
    - name: nova-compute-ironic
      image: nova-compute-ironic
      probes:
        readiness: "true"
        liveness:
          command: "true"
          type: "exec"
      daemon:
        command: nova-compute --config-file /etc/nova/nova.conf --config-file /etc/nova/nova-ironic.conf
        files:
          - nova.conf
          - nova-ironic.conf
          # {% if keystone.tls.enabled %}
          - ca-cert
          # {% endif %}
        dependencies:
          - nova-db-migrations
          - ironic-user-create
files:
  nova.conf:
    path: /etc/nova/nova.conf
    content: nova.conf.j2
    perm: "0600"
  nova-ironic.conf:
    path: /etc/nova/nova-ironic.conf
    content: nova-ironic.conf.j2
    perm: "0600"
  # {% if keystone.tls.enabled %}
  ca-cert:
    path: /opt/ccp/etc/tls/ca.pem
    content: ca-cert.pem.j2
    perm: "0644"
  # {% endif %}
